# Databricks notebook source
# MAGIC %md-sandbox
# MAGIC <div style="text-align: center; line-height: 0; padding-top: 9px;">
# MAGIC   <img src="https://databricks.com/wp-content/uploads/2018/03/db-academy-rgb-1200px.png" alt="Databricks Learning" style="width: 600px; height: 163px">
# MAGIC </div>

# COMMAND ----------

# MAGIC %md-sandbox
# MAGIC # Linear Regression
# MAGIC 
# MAGIC ##![Spark Logo Tiny](https://s3-us-west-2.amazonaws.com/curriculum-release/images/105/logo_spark_tiny.png) Introduction
# MAGIC 
# MAGIC Linear Regression is a widely used basic Supervised Machine Learning algorithm. It attempts to model the relationship between our label and one or more dependent variables by fitting a linear equation to the observed data. The Linear Regression Model explains which variables are significant predictors of the label. It does this by assigning weights (coefficients) to each feature in the model.
# MAGIC 
# MAGIC <img src="data:image/png;base64,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">
# MAGIC 
# MAGIC <small>Dataset & Figure: https://en.wikipedia.org/wiki/Anscombe%27s_quartet</small>

# COMMAND ----------

# MAGIC %md
# MAGIC ##![Spark Logo Tiny](https://s3-us-west-2.amazonaws.com/curriculum-release/images/105/logo_spark_tiny.png) Documentation

# COMMAND ----------

# MAGIC %md
# MAGIC * <a href='https://spark.apache.org/docs/latest/ml-classification-regression.html#linear-regression' target="_blank">Linear Regression documentation</a> in the Spark ML programming guide

# COMMAND ----------

# MAGIC %md
# MAGIC ##![Spark Logo Tiny](https://s3-us-west-2.amazonaws.com/curriculum-release/images/105/logo_spark_tiny.png) Linear Regression in Action

# COMMAND ----------

# MAGIC %md
# MAGIC Let's see our data on a Scatter plot:

# COMMAND ----------

from pyspark.sql import Row

d = [
  Row(4.0, 4.26),
  Row(5.0, 5.68),
  Row(6.0, 7.24),
  Row(7.0, 4.82),
  Row(8.0, 6.95),
  Row(9.0, 8.81),
  Row(10.0, 8.04),
  Row(11.0, 8.33),
  Row(12.0, 10.84),
  Row(13.0, 7.58),
  Row(14.0, 9.96)
]

df = spark.createDataFrame(d,["x","y"])
df.createOrReplaceTempView("points")

display(df)

# COMMAND ----------

# MAGIC %md
# MAGIC Now, import the *Linear Regression* class and take a look at the its parameters:

# COMMAND ----------

from pyspark.ml.regression import LinearRegression
lr = LinearRegression()

print(lr.explainParams())

# COMMAND ----------

# MAGIC %md
# MAGIC We are using a <a href="https://spark.apache.org/docs/latest/ml-features.html#vectorassembler" target="_blank">VectorAssembler</a> to create a Vector from the *x* column and then we are training our model:

# COMMAND ----------

from pyspark.ml.feature import VectorAssembler

assembler = VectorAssembler(inputCols=["x"], outputCol="features")
vecDF = assembler.transform(df)

lr.setLabelCol("y")
lrModel = lr.fit(vecDF)

# COMMAND ----------

# MAGIC %md
# MAGIC Our model is a linear equation in the form of `y = a + b*x`, where `a` is called the *intercept* and *b* is called the coefficient.
# MAGIC 
# MAGIC *If you have n dependent variables you will have n coefficients* and the equation will take the form of `y = a + b1*x1 + b2*c2 + ... + bn*xn`.
# MAGIC 
# MAGIC Print the equation to the screen:

# COMMAND ----------

intercept = lrModel.intercept
coefficient = lrModel.coefficients[0]

print("Linear Equation: y = {:.2f} + {:.2f} * x".format(intercept, coefficient))

# COMMAND ----------

# MAGIC %md
# MAGIC 
# MAGIC That's exactly the blue line in our figure displayed above. 

# COMMAND ----------

# MAGIC %md
# MAGIC Let's take a look at the point at `x=14`. Here `y` will be `3 + 0.5 * 14`, which will make it `y=10`.:

# COMMAND ----------

# MAGIC %python
# MAGIC import matplotlib.pyplot as plt
# MAGIC 
# MAGIC features, labels = zip(*spark.table("points").collect())
# MAGIC 
# MAGIC fig, ax = plt.subplots(figsize=(5,3))
# MAGIC ax.set_xlim(2.5,19)
# MAGIC ax.set_ylim(3,13)
# MAGIC ax.plot(features,labels,'o', markersize=11, color="orange")
# MAGIC ax.plot(range(2,20), list(map(lambda x: 3 + 0.5 * x, range(2,20))), markersize=0.1)
# MAGIC 
# MAGIC display(fig)

# COMMAND ----------

# MAGIC %md-sandbox
# MAGIC &copy; 2018 Databricks, Inc. All rights reserved.<br/>
# MAGIC Apache, Apache Spark, Spark and the Spark logo are trademarks of the <a href="http://www.apache.org/">Apache Software Foundation</a>.<br/>
# MAGIC <br/>
# MAGIC <a href="https://databricks.com/privacy-policy">Privacy Policy</a> | <a href="https://databricks.com/terms-of-use">Terms of Use</a> | <a href="http://help.databricks.com/">Support</a>