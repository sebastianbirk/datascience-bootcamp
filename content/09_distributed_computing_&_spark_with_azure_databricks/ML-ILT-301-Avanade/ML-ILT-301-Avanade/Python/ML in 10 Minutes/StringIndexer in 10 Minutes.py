# Databricks notebook source
# MAGIC %md-sandbox
# MAGIC <div style="text-align: center; line-height: 0; padding-top: 9px;">
# MAGIC   <img src="https://databricks.com/wp-content/uploads/2018/03/db-academy-rgb-1200px.png" alt="Databricks Learning" style="width: 600px; height: 163px">
# MAGIC </div>

# COMMAND ----------

# MAGIC %md-sandbox
# MAGIC # StringIndexer
# MAGIC 
# MAGIC ##![Spark Logo Tiny](https://s3-us-west-2.amazonaws.com/curriculum-release/images/105/logo_spark_tiny.png) Introduction
# MAGIC 
# MAGIC Many times our input data contains string-typed columns. Machine Learning algorithms favour double typed columns though. To bridge this gap, Spark provides the `StringIndexer` class, which takes string-types columns and encodes these strings into double-typed columns. Spark also provides the `IndexToString` class to "decode" indices.
# MAGIC 
# MAGIC <img src="data:image/png;base64,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
# MAGIC ">

# COMMAND ----------

# MAGIC %md
# MAGIC ##![Spark Logo Tiny](https://s3-us-west-2.amazonaws.com/curriculum-release/images/105/logo_spark_tiny.png) Documentation

# COMMAND ----------

# MAGIC %md
# MAGIC * <a href='https://spark.apache.org/docs/latest/ml-features.html#stringindexer' target="_blank">StringIndexer documentation</a> in the Spark ML programming guide
# MAGIC * <a href='https://spark.apache.org/docs/latest/ml-features.html#indextostring' target="_blank">IndexToString documentation</a> in the Spark ML programming guide

# COMMAND ----------

# MAGIC %md
# MAGIC ##![Spark Logo Tiny](https://s3-us-west-2.amazonaws.com/curriculum-release/images/105/logo_spark_tiny.png) StringIndexer in Action

# COMMAND ----------

# MAGIC %md
# MAGIC Let's create a DataFrame with a column containing categorical values:

# COMMAND ----------

from pyspark.sql import Row

d = [  
  Row(1,"red"),
  Row(2,"red"),
  Row(3,"red"),
  Row(4,"white"),
  Row(5,"green"),
  Row(6,"green"),
  Row(7,"red"),
  Row(8,"white"),
  Row(9,"green")
]

df = spark.createDataFrame(d,["id", "category"])
display(df)

# COMMAND ----------

df.printSchema()

# COMMAND ----------

# MAGIC %md
# MAGIC Now, import the *StringIndexer* class and take a look at the its parameters:

# COMMAND ----------

from pyspark.ml.feature import StringIndexer
indexer = StringIndexer()

print(indexer.explainParams())

# COMMAND ----------

# MAGIC %md
# MAGIC Go and get the *StringIndexer* create a *category*-*index* mapping:

# COMMAND ----------

(indexer
   .setInputCol("category")
   .setOutputCol("indexedCategory")
)
indexerModel = indexer.fit(df)

labels = indexerModel.labels
print(labels)

# COMMAND ----------

# MAGIC %md
# MAGIC The string indexes correspond to the array indexes of `indexerModel.labels`. By default the most frequent value comes first.

# COMMAND ----------

for i in range(0,len(labels)):
  print("{} : {}".format(i, labels[i]))

# COMMAND ----------

# MAGIC %md
# MAGIC Now, do the indexing:

# COMMAND ----------

indexedDF = indexerModel.transform(df)
display(indexedDF)

# COMMAND ----------

indexedDF.printSchema()

# COMMAND ----------

# MAGIC %md
# MAGIC ##![Spark Logo Tiny](https://s3-us-west-2.amazonaws.com/curriculum-release/images/105/logo_spark_tiny.png) IndexToString
# MAGIC 
# MAGIC The *IndexToString* class takes an indexed column and decodes the indices to their original string values. 
# MAGIC 
# MAGIC It does it by pulling the data from the indexed column's metadata:

# COMMAND ----------

indexedDF.schema[2].metadata

# COMMAND ----------

from pyspark.ml.feature import IndexToString

converter = IndexToString(inputCol="indexedCategory", outputCol="originalCategory")
convertedDF = converter.transform(indexedDF)

display(convertedDF)

# COMMAND ----------

# MAGIC %md-sandbox
# MAGIC &copy; 2018 Databricks, Inc. All rights reserved.<br/>
# MAGIC Apache, Apache Spark, Spark and the Spark logo are trademarks of the <a href="http://www.apache.org/">Apache Software Foundation</a>.<br/>
# MAGIC <br/>
# MAGIC <a href="https://databricks.com/privacy-policy">Privacy Policy</a> | <a href="https://databricks.com/terms-of-use">Terms of Use</a> | <a href="http://help.databricks.com/">Support</a>