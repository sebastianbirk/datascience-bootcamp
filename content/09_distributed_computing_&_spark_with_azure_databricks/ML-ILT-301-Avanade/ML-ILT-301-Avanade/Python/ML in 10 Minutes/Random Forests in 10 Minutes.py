# Databricks notebook source
# MAGIC %md-sandbox
# MAGIC <div style="text-align: center; line-height: 0; padding-top: 9px;">
# MAGIC   <img src="https://databricks.com/wp-content/uploads/2018/03/db-academy-rgb-1200px.png" alt="Databricks Learning" style="width: 600px; height: 163px">
# MAGIC </div>

# COMMAND ----------

# MAGIC %md
# MAGIC # Random Forests
# MAGIC 
# MAGIC ##![Spark Logo Tiny](https://s3-us-west-2.amazonaws.com/curriculum-release/images/105/logo_spark_tiny.png) Introduction
# MAGIC 
# MAGIC Random forests or random decision forests are an ensemble learning method for classification and regression, that operate by constructing a multitude of decision trees at training time and outputting the class that is the mode of the classes (classification) or mean prediction (regression) of the individual trees. Random forests correct for decision trees' habit of overfitting to their training set.
# MAGIC 
# MAGIC The `spark.ml` implementation supports random forests for binary and multiclass **classification and** for **regression**, using both continuous and categorical features.
# MAGIC 
# MAGIC <small><i>Source: https://spark.apache.org/docs/latest/ml-classification-regression.html#random-forests</i></small>

# COMMAND ----------

# MAGIC %md
# MAGIC ##![Spark Logo Tiny](https://s3-us-west-2.amazonaws.com/curriculum-release/images/105/logo_spark_tiny.png) Documentation

# COMMAND ----------

# MAGIC %md
# MAGIC * <a href='https://spark.apache.org/docs/latest/ml-classification-regression.html#random-forest-classifier' target="_blank">Random Forest Classifier</a> in the Spark ML programming guide
# MAGIC * <a href='https://spark.apache.org/docs/latest/ml-classification-regression.html#random-forest-regression' target="_blank">Random Forest Regression</a> in the Spark ML programming guide

# COMMAND ----------

# MAGIC %md
# MAGIC ##![Spark Logo Tiny](https://s3-us-west-2.amazonaws.com/curriculum-release/images/105/logo_spark_tiny.png) Getting Started
# MAGIC 
# MAGIC Run the following cell to configure our "classroom."

# COMMAND ----------

# MAGIC %run "../../Includes/Classroom Setup"

# COMMAND ----------

# MAGIC %md
# MAGIC ##![Spark Logo Tiny](https://s3-us-west-2.amazonaws.com/curriculum-release/images/105/logo_spark_tiny.png) Random Forests in Action

# COMMAND ----------

# MAGIC %md-sandbox
# MAGIC ### Our dataset
# MAGIC 
# MAGIC We are using the <a href="https://archive.ics.uci.edu/ml/datasets/wine">Wine Data Set</a> to train a Random Forest Regressor Model. It will predict wine quality by analysing the chemical attributes of different wine samples.
# MAGIC 
# MAGIC > Dua, D. and Karra Taniskidou, E. (2017). UCI Machine Learning Repository [http://archive.ics.uci.edu/ml]. Irvine, CA: University of California, School of Information and Computer Science.
# MAGIC 
# MAGIC <a href="https://www.pexels.com/photo/clear-glass-of-wine-935240/" target="_blank"><img src="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAASABIAAD/4QDIRXhpZgAATU0AKgAAAAgABwESAAMAAAABAAEAAAEaAAUAAAABAAAAYgEbAAUAAAABAAAAagEoAAMAAAABAAIAAAExAAIAAAAPAAAAcgEyAAIAAAAUAAAAgodpAAQAAAABAAAAlgAAAAAAAABIAAAAAQAAAEgAAAABUGl4ZWxtYXRvciAzLjcAADIwMTg6MDU6MjkgMTU6MDU6MTAAAAOgAQADAAAAAQABAACgAgAEAAAAAQAAAligAwAEAAAAAQAAAKcAAAAA/+EJ9Gh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8APD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iWE1QIENvcmUgNS40LjAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1wOk1vZGlmeURhdGU9IjIwMTgtMDUtMjlUMTU6MDU6MTAiIHhtcDpDcmVhdG9yVG9vbD0iUGl4ZWxtYXRvciAzLjciPiA8ZGM6c3ViamVjdD4gPHJkZjpCYWcvPiA8L2RjOnN1YmplY3Q+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDw/eHBhY2tldCBlbmQ9InciPz4A/+0AOFBob3Rvc2hvcCAzLjAAOEJJTQQEAAAAAAAAOEJJTQQlAAAAAAAQ1B2M2Y8AsgTpgAmY7PhCfv/AABEIAKcCWAMBIgACEQEDEQH/xAAfAAABBQEBAQEBAQAAAAAAAAAAAQIDBAUGBwgJCgv/xAC1EAACAQMDAgQDBQUEBAAAAX0BAgMABBEFEiExQQYTUWEHInEUMoGRoQgjQrHBFVLR8CQzYnKCCQoWFxgZGiUmJygpKjQ1Njc4OTpDREVGR0hJSlNUVVZXWFlaY2RlZmdoaWpzdHV2d3h5eoOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4eLj5OXm5+jp6vHy8/T19vf4+fr/xAAfAQADAQEBAQEBAQEBAAAAAAAAAQIDBAUGBwgJCgv/xAC1EQACAQIEBAMEBwUEBAABAncAAQIDEQQFITEGEkFRB2FxEyIygQgUQpGhscEJIzNS8BVictEKFiQ04SXxFxgZGiYnKCkqNTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqCg4SFhoeIiYqSk5SVlpeYmZqio6Slpqeoqaqys7S1tre4ubrCw8TFxsfIycrS09TV1tfY2dri4+Tl5ufo6ery8/T19vf4+fr/2wBDAAEBAQEBAQIBAQIDAgICAwQDAwMDBAYEBAQEBAYHBgYGBgYGBwcHBwcHBwcICAgICAgJCQkJCQsLCwsLCwsLCwv/2wBDAQICAgMDAwUDAwULCAYICwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwv/3QAEACb/2gAMAwEAAhEDEQA/AP7+KKTk8EUtABRRRQAUUUUAFFFFAAelVbKOeO2VbnaJOS23JXJ9M1aooAwtTkWK9hjk6ThkH+8OR+mfyr+Vv9pLVLD9m3/g6k+A/j++lFtZ/GD4c33hiV2OFe5tnuGiX6lkhUfUV/VZq9qtxbJL/Fbusq49V6/oSK/jy/4OwtK1z4Iar+y7/wAFFfCqOLj4UePEiuZY+ohnaK8jBPoWtHX/AIHQtzaDvFo/siorE8NeINL8WeHNP8VaJIJrLU7aK7t5FOQ8Uyh0I9ipBrboMQooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooADUYLBvmqSkIzQAtGKQccUtACDgc0tFFABRRRQAUUUUAFFFFAH/9D+/VN235zk/lT6TpS0AFFFFABRRRQAUUUUAFFFFAEcqlomUdwRX8qv/B2v4j8XD/gmhpHw88P+HG1+w8WeMdJ027njbDWU8bGSHA65mZTED2Le9f1Vyb/Lby/vYOPrX4j/APBSX9iTx38ev2Nfjv4F8Iavd6xqni02njTwxpt1hv7O1vRo4Jkt4GzkRzzWqnafuvI+ODUzdlc7cDFObv8Ad3vp+t/kfof+w14btvBP7Hnww8GWepz6xbab4Y0yC0u7rieW1SBBCZP9tY9qt7ivqyvyr/4Jj/tJeK/ivZeMvgZ8RNAk0HWvhzJplxCkn/LXTPEdt/aFpleqPAGe2kXs0WR1r9VKq99TDEU+SrKHZsKKx9c8QaL4Z09tV1+5jtbdSF3yHGWbooHUsewGSe1cbpfiLxp4qvWaw0ttI0sY23N9xczf7luOUHvKQ3+xTUW9TBs9IZlQZcgD3pwOeRXNJ4S0Qy/ab2I3U3/PSdi7D6Z4X8MVuwoYiIY1xGigD60OwFiiiikMKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigBP4s0tIRmgAdR3oAWiiigAz2oooxQAUmOc0tFABRRRQB//0f7+KKT2o5zQAtIFC5x35paKACiiigAooooAKKKKACvKRpvi4eONT/tIW50VoYG04xk+cJDv+0LIDxjOwoR6kHpXq1Ur0MFSdeTGc/getJq6NKU3GV0fzW/8E8/2ydL+KP8AwX3/AGtfgLpUkZstP0DQYYCp5afw8xtrj8Q94Qf92v6NdQ8QzyXL6T4biF3docSMxxDDn++w6n/YX5j3wOa/gb/ZB+G/iX/gnv8A8HaHiT4YeP72WbT/AI0pr95pd9kj7TZ6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"></a>

# COMMAND ----------

df = spark.read.parquet("/mnt/training/wine.parquet")
display(df)

# COMMAND ----------

# MAGIC %md
# MAGIC Now, create a bar chart that displays the distribution of the `quality` column:

# COMMAND ----------

display(df.groupBy("quality").count().orderBy("quality"))

# COMMAND ----------

# MAGIC %md
# MAGIC ### Training a Random Forest Regressor

# COMMAND ----------

# MAGIC %md
# MAGIC Let's take a look at the expert parameters of the Random Forest Regressor

# COMMAND ----------

from pyspark.ml.regression import RandomForestRegressor

rf = RandomForestRegressor()

print(rf.explainParams())

# COMMAND ----------

# MAGIC %md
# MAGIC Now, train a Random Forest Regressor model:

# COMMAND ----------

from pyspark.ml.feature import VectorAssembler

featureCols = [c for c in df.columns if c != "quality"]
assembler = VectorAssembler(inputCols=featureCols, outputCol="features")
vecDF = assembler.transform(df)

(trainingDF, testDF) = vecDF.randomSplit([0.8, 0.2], seed=273)

rf.setLabelCol("quality")
rfModel = rf.fit(vecDF)

# COMMAND ----------

# MAGIC %md
# MAGIC Let's evaluate our Random Forest Regressor Model:

# COMMAND ----------

from pyspark.ml.evaluation import RegressionEvaluator

predictedDF = rfModel.transform(testDF)

eval = (RegressionEvaluator()
        .setLabelCol("quality")
        .setMetricName("mae")
       )

print("Mean Absolute Error: {:.2f}".format(eval.evaluate(predictedDF)))

# COMMAND ----------

# MAGIC %md
# MAGIC #### What are the features with the most predictive power in each tree?

# COMMAND ----------

rfModel.trees

# COMMAND ----------

print("Number of trees trained: {}\nFeature importances in individual trees:\n".format(len(rfModel.trees)))
for ind, dtModel in enumerate(rfModel.trees):
  print("Decision Tree #{}".format(ind + 1))
  imp = dtModel.featureImportances
  colNames = dict(zip(range(0, len(featureCols)), featureCols))
  importances = sorted(zip(imp.values, imp.indices), reverse=True)
  for f in importances:
    print(("  " + colNames[f[1]] + " (id=" + str(f[1]) + "): ").ljust(30) + str(f[0]))
  print()

# COMMAND ----------

# MAGIC %md-sandbox
# MAGIC &copy; 2018 Databricks, Inc. All rights reserved.<br/>
# MAGIC Apache, Apache Spark, Spark and the Spark logo are trademarks of the <a href="http://www.apache.org/">Apache Software Foundation</a>.<br/>
# MAGIC <br/>
# MAGIC <a href="https://databricks.com/privacy-policy">Privacy Policy</a> | <a href="https://databricks.com/terms-of-use">Terms of Use</a> | <a href="http://help.databricks.com/">Support</a>